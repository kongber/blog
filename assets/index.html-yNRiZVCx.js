import{_ as i,c as a,a as n,o as h}from"./app-G7cDrxo-.js";const e={};function l(k,s){return h(),a("div",null,s[0]||(s[0]=[n(`<h2 id="_1-openssl-简介" tabindex="-1"><a class="header-anchor" href="#_1-openssl-简介"><span>1. OpenSSL 简介</span></a></h2><p>OpensSSL 是一个开放源代码的软件库包，应用程序可以使用这个包来进行安全通信。 库地址：<a href="https://www.openssl.org/" target="_blank" rel="noopener noreferrer">https://www.openssl.org/</a></p><h2 id="_2-openssl-库编译" tabindex="-1"><a class="header-anchor" href="#_2-openssl-库编译"><span>2. OpenSSL 库编译</span></a></h2><h3 id="_2-1-window-编译" tabindex="-1"><a class="header-anchor" href="#_2-1-window-编译"><span>2.1 Window 编译</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Windows 中编译 OpenSSL 需使用 msvc 进行编译，并且增加 no-asm 编译选项，不使用汇编模式进行编译。</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">perl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Configure</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> VC-WIN32</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> shared</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> no-asm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --prefix=E:\\openssl\\xxx\\ --openssldir=E:\\openssl\\xxx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">perl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Configure</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> VC-WIN64A</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> shared</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> no-asm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --prefix=E:\\openssl\\xxx\\ --openssldir=E:\\openssl\\xxx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nmake</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nmake</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-linux-编译" tabindex="-1"><a class="header-anchor" href="#_2-2-linux-编译"><span>2.2 Linux 编译</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./config</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> shared</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> no-asm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --prefix=/home/xxx/</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">make</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">make</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-ios-编译" tabindex="-1"><a class="header-anchor" href="#_2-3-ios-编译"><span>2.3 iOS 编译</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">export</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> DEVELOPER</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\`</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">xcode-select</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -print-path</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\`</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">export</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> PLATFORM</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">iPhoneOS</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">export</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> CROSS_TOP</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">DEVELOPER</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/Platforms/</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">PLATFORM</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">.platform/Developer</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">export</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> IOS_SDK_VERSION</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">export</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> CROSS_SDK</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">PLATFORM</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}\${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">IOS_SDK_VERSION</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">.sdk</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">export</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> BUILD_TOOLS</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">DEVELOPER</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">export</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> CC</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">BUILD_TOOLS</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/bin/gcc -fembed-bitcode  -miphoneos-version-min=8.0 -arch arm64</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./Configure</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> iphoneos-cross</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> no-asm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -no-shared</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> enable-ntls</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-android-编译" tabindex="-1"><a class="header-anchor" href="#_2-4-android-编译"><span>2.4 Android 编译</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">export</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> PATH</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">opt</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">toolchains</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">android</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">android-ndk-r26d</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">toolchains</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">llvm</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">prebuilt</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">linux-x86_64</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">bin</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">$PATH</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">export</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> ANDROID_NDK_HOME</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">opt</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">toolchains</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">android</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">android-ndk-r26d</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">export</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> ANDROID_NDK_ROOT</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">opt</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">toolchains</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">android</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">android-ndk-r26d</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./Configure</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> android-arm64</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -D__ANDROID_API__=21</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --prefix=/xxx/tongsuo-android</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-5-交叉编译" tabindex="-1"><a class="header-anchor" href="#_2-5-交叉编译"><span>2.5 交叉编译</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./config</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> shared</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> no-asm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --prefix=/home/xxx/</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --cross-compile-prefix=arm-linux-gnueabihf-</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">**</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">make </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">make</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">**</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-openssl-常用命令" tabindex="-1"><a class="header-anchor" href="#_3-openssl-常用命令"><span>3. OpenSSL 常用命令</span></a></h2><h3 id="_3-1-证书格式转换" tabindex="-1"><a class="header-anchor" href="#_3-1-证书格式转换"><span>3.1 <strong>证书格式转换</strong></span></a></h3><h4 id="_3-1-1-pem-⇒-der" tabindex="-1"><a class="header-anchor" href="#_3-1-1-pem-⇒-der"><span>3.1.1 PEM ⇒ DER</span></a></h4><p>openssl x509 -outform der -in certificate.pem -out certificate.der</p><h4 id="_3-1-2-der-⇒-pem" tabindex="-1"><a class="header-anchor" href="#_3-1-2-der-⇒-pem"><span>3.1.2 DER ⇒ PEM</span></a></h4><p>openssl x509 -inform der -in certificate.cer -out certificate.pem</p><h4 id="_3-1-3-pem-⇒-pfx" tabindex="-1"><a class="header-anchor" href="#_3-1-3-pem-⇒-pfx"><span>3.1.3 PEM ⇒ PFX</span></a></h4><p>openssl pkcs12 -export -out certificate.pfx -inkey privateKey.key -in certificate.crt -certfile CACert.crt</p><h4 id="_3-1-4-pfx-⇒-pem" tabindex="-1"><a class="header-anchor" href="#_3-1-4-pfx-⇒-pem"><span>3.1.4 PFX ⇒ PEM</span></a></h4><p>openssl pkcs12 -in certificate.pfx -out certificate.cer -nodes</p><h4 id="_3-1-5-pem-⇒-p7b" tabindex="-1"><a class="header-anchor" href="#_3-1-5-pem-⇒-p7b"><span>3.1.5 PEM ⇒ P7B</span></a></h4><p>openssl crl2pkcs7 -nocrl -certfile certificate.cer -out certificate.p7b -certfile CACert.cer</p><h4 id="_3-1-6-p7b-⇒-pem" tabindex="-1"><a class="header-anchor" href="#_3-1-6-p7b-⇒-pem"><span>3.1.6 P7B ⇒ PEM</span></a></h4><p>openssl pkcs7 -print_certs -in certificate.p7b -out certificate.cer</p><h4 id="_3-1-7-p7b-⇒-pfx" tabindex="-1"><a class="header-anchor" href="#_3-1-7-p7b-⇒-pfx"><span>3.1.7 P7B ⇒ PFX</span></a></h4><p>openssl pkcs7 -print_certs -in certificate.p7b -out certificate.cer</p><p>openssl pkcs12 -export -in certificate.cer -inkey privateKey.key -out certificate.pfx -certfile CACert.cer</p><h3 id="_3-2-多级证书链生成" tabindex="-1"><a class="header-anchor" href="#_3-2-多级证书链生成"><span>3.2 多级证书链生成</span></a></h3><h4 id="_3-2-1-rsa-证书链" tabindex="-1"><a class="header-anchor" href="#_3-2-1-rsa-证书链"><span>3.2.1 RSA 证书链</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 生成根 CA</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> genrsa</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -des3</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.key</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2048</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> req</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -new</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -x509</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -days</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3650</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.key -out root.crt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 生成二级 CA</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> genrsa</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -des3</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.key</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2048</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rsa</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.key</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> req</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -new</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -days</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3650</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.csr</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ca</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -extensions</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> v3_ca</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.csr</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -config</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/pki/tls/openssl.cnf</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -days</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3650</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -cert</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -keyfile</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.key</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 生成三级 CA</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> genrsa</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -des3</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> third.key</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2048</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rsa</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> third.key -out third.key</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> req</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -new</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -days</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3650</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> third.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> third.csr</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ca</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -extensions</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> v3_ca</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> third.csr</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -config</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/pki/tls/openssl.cnf</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -days</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3650</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> third.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -cert</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -keyfile</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.key</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-2-ecc-证书链" tabindex="-1"><a class="header-anchor" href="#_3-2-2-ecc-证书链"><span>3.2.2 ECC 证书链</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 生成根 CA </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ecparam</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -name</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> prime256v1</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -genkey</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> req</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -new</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -x509</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -days</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3650</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.crt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 生成二级 CA</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ecparam</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -name</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> prime256v1</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -genkey</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> req</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -new</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -days</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3650</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.csr</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ca</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -extensions</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> v3_ca</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.csr</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -days</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3650</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.pem</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -cert</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.pem</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -keyfile</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.key</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 生成三级 CA </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">同生成二级证书</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-3-sm2-证书链" tabindex="-1"><a class="header-anchor" href="#_3-2-3-sm2-证书链"><span>3.2.3 SM2 证书链</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 生成根 CA: </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ecparam</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -genkey</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -name</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SM2</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.key</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> req</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -new</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -x509</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -days</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3650</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.crt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 生成二级 CA</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ecparam</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -genkey</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -name</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> SM2</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.key</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> req</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -new</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -days</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3650</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.csr</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ca</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -extensions</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> v3_ca</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.csr</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -days</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3650</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> second.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -cert</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -keyfile</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.key</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-证书链校验" tabindex="-1"><a class="header-anchor" href="#_3-3-证书链校验"><span>3.3 证书链校验</span></a></h3><p>openssl verify -CAfile cert1.pem(根+sub) cert2.pem(其他)</p><h3 id="_3-4-ocsp-校验" tabindex="-1"><a class="header-anchor" href="#_3-4-ocsp-校验"><span>3.4 OCSP 校验</span></a></h3><p>openssl ocsp -issuer ocsp.cer -cert iwall.pem -text -url http://xxx.8080</p><h3 id="_3-5-p12-生成及解析" tabindex="-1"><a class="header-anchor" href="#_3-5-p12-生成及解析"><span>3.5 P12 生成及解析</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># P12 导出证书</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pkcs12</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -clcerts</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -nokeys</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apple_cert.pem</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apple_cert.p12</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># P12 导出私钥</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pkcs12</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -nocerts</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -nodes</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apple.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apple_cert.p12</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># P12 使用 key 导出公私钥</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rsa</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apple.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apple_rsa_pri.pemopenssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rsa</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apple.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -pubout</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apple_rsa_pub.pem</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ec</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apple.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apple_ec_pri.pemopenssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ec</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apple.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -pubout</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apple_ec_pub.pem</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># P12 生成</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pkcs12</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -export</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -clcerts</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -inkey</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Authorized.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Authorized.p12</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-6-hash-计算" tabindex="-1"><a class="header-anchor" href="#_3-6-hash-计算"><span>3.6 Hash 计算</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># SHA256 </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dgst</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -sha256</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> datafile</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># SM3</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dgst</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -sm3 datafile</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># SHA256-HMAC</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dgst</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -sha256</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -hmac</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> keystr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> datafile</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># SM3-HMAC</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dgst</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -sm3</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -hmac</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> keystr</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> datafile</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-7-加解密计算" tabindex="-1"><a class="header-anchor" href="#_3-7-加解密计算"><span>3.7 加解密计算</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">测试生成</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> RSA</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 密钥对的速度</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">time</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> openssl genpkey -algorithm RSA -out private_key_3072.pem -pkeyopt rsa_keygen_bits:3072</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-8-tls-服务" tabindex="-1"><a class="header-anchor" href="#_3-8-tls-服务"><span>3.8 TLS 服务</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 开启 TLS 服务</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> s_server</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -accept</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4433</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> server.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -cert</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> server.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -CAfile</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> certificate_chain.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -verify</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -debug</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> s_server</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -accept</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 127.0.0.1:4433</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -enc_cert</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> test_certs/double_cert/SE.cert.pem</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -enc_key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> test_certs/double_cert/SE.key.pem</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -sign_cert</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> test_certs/double_cert/SS.cert.pem</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -sign_key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> test_certs/double_cert/SS.key.pem</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -enable_ntls</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># BabaSSL 创建 TLS 请求</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> s_client</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -connect</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 127.0.0.1:4433</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -cipher</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ECC-SM2-WITH-SM4-SM3</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -enable_ntls</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -ntls</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> s_client</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -connect</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 127.0.0.1:4433</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -cipher</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ECDHE-SM2-WITH-SM4-SM3</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -sign_cert</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> test_certs/double_cert/CS.cert.pem</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -sign_key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> test_certs/double_cert/CS.key.pem</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -enc_cert</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> test_certs/double_cert/CE.cert.pem</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -enc_key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> test_certs/double_cert/CE.key.pem</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -enable_ntls</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -ntls</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-9-生成-bks" tabindex="-1"><a class="header-anchor" href="#_3-9-生成-bks"><span>3.9 生成 bks</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">keytool</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -keystore</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> truststore.bks</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -keypass</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> qwer1234</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -storepass</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> qwer1234</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-storetype</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> BKS</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -provider</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> org.bouncycastle.jce.provider.BouncyCastleProvider</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-alias</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> TrustCA</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -import</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -trustcacerts</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -file</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> localhost_cert_chain.pem</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-providerpath</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /Users/sm2/Desktop/certs/bcprov-jdk18on-177.jar</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-参考链接" tabindex="-1"><a class="header-anchor" href="#_4-参考链接"><span>4. 参考链接</span></a></h3><ol><li>代码生成 CSR 文件 <a href="https://www.cnblogs.com/chevin/p/11041713.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/chevin/p/11041713.html</a></li><li>生成 ED25519 证书 <a href="https://blog.pinterjann.is/ed25519-certificates.html" target="_blank" rel="noopener noreferrer">https://blog.pinterjann.is/ed25519-certificates.html</a></li><li>OpenSSL 测试命令 <a href="https://blog.csdn.net/carefree2005/article/details/120889451" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/carefree2005/article/details/120889451</a></li><li>OpenSSL 简介 <a href="https://deepwiki.com/openssl/openssl/2.1-tlsssl-architecture" target="_blank" rel="noopener noreferrer">https://deepwiki.com/openssl/openssl/2.1-tlsssl-architecture</a></li></ol>`,53)]))}const p=i(e,[["render",l]]),r=JSON.parse('{"path":"/article/dcv6gqr2/","title":"Openssl","lang":"zh-CN","frontmatter":{"title":"Openssl","createTime":"2025/04/15 16:47:44","permalink":"/article/dcv6gqr2/"},"readingTime":{"minutes":3.09,"words":927},"git":{"updatedTime":1751457679000,"contributors":[{"name":"Kongber","username":"Kongber","email":"kongmongolia@gmail.com","commits":8,"avatar":"https://avatars.githubusercontent.com/Kongber?v=4","url":"https://github.com/Kongber"}]},"filePathRelative":"notes/C.safe/C1.cipher/algorithm/openssl.md","headers":[],"categoryList":[{"id":"4358b5","sort":10000,"name":"notes"},{"id":"63b13f","sort":10013,"name":"C.safe"},{"id":"42ad35","sort":10018,"name":"C1.cipher"},{"id":"7adf9c","sort":10017,"name":"algorithm"}]}');export{p as comp,r as data};
